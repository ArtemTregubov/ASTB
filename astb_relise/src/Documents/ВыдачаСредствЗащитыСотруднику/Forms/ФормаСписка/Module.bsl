////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	// СтандартныеПодсистемы.Печать
	УправлениеПечатью.ПриСозданииНаСервере(ЭтаФорма);
	// Конец СтандартныеПодсистемы.Печать
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ ПОДСИСТЕМЫ "ПЕЧАТЬ"

// СтандартныеПодсистемы.Печать
&НаКлиенте
Процедура Подключаемый_ВыполнитьКомандуПечати(Команда)
	
  	УправлениеПечатьюКлиент.ВыполнитьПодключаемуюКомандуПечати(Команда, ЭтаФорма, Элементы.Список);
  
КонецПроцедуры

// Конец СтандартныеПодсистемы.Печать

#Область АдресноеХранение

&НаКлиенте
Процедура АХ_ШтрихкодПланаСнятияПриИзменении(Элемент)
		
	Если АХ_ШтрихкодПланаСнятия = "" Тогда
		Возврат;
	Конецесли;
	
	Документ = АХ_НайтиДокументПоШтрихкоду(АХ_ШтрихкодПланаСнятия);
	Если Документ = Неопределено Тогда
		
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю(нСтр("ru='Документ не найден'", "ru"));
	иначе
		
		ПоказатьЗначение(,Документ);
		
	КонецЕсли;
	
КонецПроцедуры

Функция АХ_НайтиДокументПоШтрихкоду(Штрихкод)
	
	СтруктураОбработкиОшибок = АХ_ОбменВызовСервера.ИнициализироватьСтруктуруОбработкиОшибок();
	
	Прокси = АХ_ОбменВызовСервера.ПолучитьПрокси(СтруктураОбработкиОшибок);
	Если Прокси = Неопределено Тогда 
		Возврат неопределено;
	КонецЕсли;
	
	СтруктураДанныхДокумента = Прокси.УправленческийДокументПоПлануСнятия(Штрихкод);
	
	Если СтруктураДанныхДокумента = Неопределено Тогда 
		Возврат Неопределено;
	Иначе
		
		СтруктураДанныхДокумента = СериализаторXDTO.ПрочитатьXDTO(СтруктураДанныхДокумента);
		
		Идентификатор = Новый УникальныйИдентификатор(СтруктураДанныхДокумента.IDДокумента);
		Ссылка = Документы[СтруктураДанныхДокумента.ВидДокумента].ПолучитьСсылку(Идентификатор);
		
		Если Ссылка.Пустая() Тогда
			Возврат Неопределено;
		Иначе
			Возврат Ссылка;
		КонецЕсли;
		
	КонецЕсли;
	
КонецФункции

#КонецОбласти


