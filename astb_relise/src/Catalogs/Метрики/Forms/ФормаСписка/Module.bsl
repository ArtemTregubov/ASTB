
&НаСервере
Процедура ЗаполнитьНаСервере()
	
	//чтение данных из макета
	ВременныйФайлМетрик	= ПолучитьИмяВременногоФайла("xml");
	МакетДанных 		= Справочники.Метрики.ПолучитьМакет("Метрики");
	МакетДанных.Записать(ВременныйФайлМетрик);
	
	Чтение = Новый ЧтениеXML;
	Чтение.ОткрытьФайл(ВременныйФайлМетрик);
	
	Пока Чтение.Прочитать() Цикл
		
		Если Чтение.ТипУзла = ТипУзлаXML.НачалоЭлемента Тогда
			
			Если Чтение.ЛокальноеИмя = "metrika_item" Тогда
				
				Код          	= Число(СокрЛП(Чтение.ЗначениеАтрибута("metrika_code")));
				Наименование	= СокрЛП(Чтение.ЗначениеАтрибута("metrika_name"));
				
				Метрика = Справочники.Метрики.НайтиПоКоду(Код);
				
				Если Метрика.Пустая() Тогда
					
					Метрика = Справочники.Метрики.СоздатьЭлемент();
					Метрика.Код = Код;
					Метрика.Наименование = Наименование;
					Метрика.Записать();
					
				КонецЕсли;	
				
			КонецЕсли;
			
		КонецЕсли;	
		
	КонецЦикла;
	
	Чтение.Закрыть();
	
	УдалитьФайлы(ВременныйФайлМетрик);
	
КонецПроцедуры

&НаКлиенте
Процедура Заполнить(Команда)
	
	ЗаполнитьНаСервере();
	
	ЭтаФорма.ОбновитьОтображениеДанных();
	
КонецПроцедуры
