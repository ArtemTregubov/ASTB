Функция ПолучитьЦену(Номенклатура,Организация,Дата,Поставщик = Неопределено) Экспорт
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	               |	МАКСИМУМ(ЦеныНоменклатурыСрезПоследних.Цена) КАК Цена
	               |ИЗ
	               |	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
	               |			&ДатаЗапроса,
	               |			Организация = &Организация
	               |				И Номенклатура = &Номенклатура
	               |				И Поставщик = &Поставщик) КАК ЦеныНоменклатурыСрезПоследних";
	Запрос.УстановитьПараметр("ДатаЗапроса",Дата);
	Запрос.УстановитьПараметр("Организация",Организация);
	Запрос.УстановитьПараметр("Номенклатура",Номенклатура);
	Запрос.УстановитьПараметр("Поставщик",?(Поставщик = Неопределено,Номенклатура.Поставщик,Поставщик));
	
	ДанныеРегистра = Запрос.Выполнить().Выгрузить();
	Если ДанныеРегистра.Количество() > 0 Тогда
		ИтогЦена = ДанныеРегистра[0].Цена;
	Иначе
		ИтогЦена = 0;
	КонецЕсли;
	Возврат ИтогЦена;
КонецФункции