////////////////////////////////////////////////////////////////////////////////
// Подсистема "Физические лица"
//
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// ПРОГРАММНЫЙ ИНТЕРФЕЙС

//АсТБ_Andrey_NSK_********************************************************************

// Функция раскладывает Наименование в массив из трех элементов
//
// Параметры
//  ФИО  - строка - наименование
//
// Возвращаемое значение:
//   Массив   - массив из трех элементов, Фамилия, Имя, Отчество
//
Функция ПолучитьМассивФИО(Знач ФИО) Экспорт

	МассивФИО = Новый Массив;
	МассивФИО.Добавить("");
	МассивФИО.Добавить("");
	МассивФИО.Добавить("");
	
	МассивПодсток = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(ФИО, " ");
	Для Индекс = 0 По МассивПодсток.ВГраница() Цикл
		Если Индекс < 3 Тогда
			МассивФИО[Индекс] = МассивПодсток[Индекс];
		Иначе
			МассивФИО[2] = МассивФИО[2] + " " + МассивПодсток[Индекс];
		КонецЕсли;
	КонецЦикла;

	Возврат МассивФИО;
	
КонецФункции

//АсТБ_Andrey_NSK_********************************************************************

//АсТБ_Alexey_********************************************************************

Процедура ЗаписатьФИОФизЛиц(МассивФИО,ФизЛицо) Экспорт
	
	УстановитьПривилегированныйРежим(ИСТИНА);
	
	ФИОСрез = РегистрыСведений.ФИОФизическихЛиц.ПолучитьПоследнее(,Новый Структура("ФизическоеЛицо",ФизЛицо));
	
	СтрокаСреза = ФИОСрез.Фамилия + ФИОСрез.Имя + ФИОСрез.Отчество;
	
	Если (ФИОСрез.Фамилия <> МассивФИО[0]) или (ФИОСрез.Фамилия <> МассивФИО[1]) или (ФИОСрез.Фамилия <> МассивФИО[2]) Тогда
		
		МенеджерЗаписи = РегистрыСведений.ФИОФизическихЛиц.СоздатьМенеджерЗаписи();
		
		МенеджерЗаписи.ФизическоеЛицо = ФизЛицо;
		Если ПустаяСтрока(СтрокаСреза) Тогда
			МенеджерЗаписи.Период = '19000101';
		Иначе
			МенеджерЗаписи.Период = ТекущаяДата();
		КонецЕсли;
		
		МенеджерЗаписи.Фамилия 	= МассивФИО[0];
		МенеджерЗаписи.Имя 		= МассивФИО[1];
		МенеджерЗаписи.Отчество = МассивФИО[2];
		
		МенеджерЗаписи.Записать(Истина);
	КонецЕсли;
	
КонецПроцедуры

//АсТБ_Alexey_********************************************************************